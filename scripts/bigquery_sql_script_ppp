CREATE SCHEMA ppp;

CREATE TABLE ppploans_dw_lgl.ppp.Entity ( 
 );

CREATE TABLE ppploans_dw_lgl.ppp.dim_borrower ( 
	borrower_id int64 NOT NULL  ,
	name string  ,
	naics_code int64  
 );

ALTER TABLE ppploans_dw_lgl.ppp.dim_borrower ADD PRIMARY KEY ( borrower_id )  NOT ENFORCED;

CREATE TABLE ppploans_dw_lgl.ppp.dim_date ( 
	date_id int64 NOT NULL  ,
	date_original_format date  ,
	date_iso_format date  ,
	year_number int64  ,
	month_number int64  ,
	day_number int64  ,
	month_name string  ,
	day_name string  ,
	week_of_the_year int64  ,
	week_of_the_month int64  
 );

ALTER TABLE ppploans_dw_lgl.ppp.dim_date ADD PRIMARY KEY ( date_id )  NOT ENFORCED;

CREATE TABLE ppploans_dw_lgl.ppp.dim_loan ( 
	loan_number int64 NOT NULL  ,
	processing_method string  ,
	loan_status string  ,
	term int64  
 );

ALTER TABLE ppploans_dw_lgl.ppp.dim_loan ADD PRIMARY KEY ( loan_number )  NOT ENFORCED;

CREATE TABLE ppploans_dw_lgl.ppp.dim_location ( 
	location_id int64 NOT NULL  ,
	address string  ,
	city string  ,
	state string  ,
	zip int64  
 );

ALTER TABLE ppploans_dw_lgl.ppp.dim_location ADD PRIMARY KEY ( location_id )  NOT ENFORCED;

CREATE TABLE ppploans_dw_lgl.ppp.dim_originating_lender ( 
	origin_lender_id int64 NOT NULL  ,
	name string  ,
  
 );

ALTER TABLE ppploans_dw_lgl.ppp.dim_originating_lender ADD PRIMARY KEY ( origin_lender_id )  NOT ENFORCED;

CREATE TABLE ppploans_dw_lgl.ppp.dim_servicing_lender ( 
	service_lender_id int64 NOT NULL  ,
	name string  ,
 );

ALTER TABLE ppploans_dw_lgl.ppp.dim_servicing_lender ADD PRIMARY KEY ( lender_id )  NOT ENFORCED;

CREATE TABLE ppploans_dw_lgl.ppp.facts_ppp ( 
	fact_id int64 NOT NULL  ,
	initial_approval_amount float  ,
	current_approval_amount float  ,
	undisbursed_amount float  ,
	foregiveness_amount float  ,
	location_id int64 NOT NULL  ,
	date_id int64 NOT NULL  ,
	loan_number int64 NOT NULL  ,
	borrower_id int64 NOT NULL  ,
	lender_id int64 NOT NULL  ,
    origin_lender_id NOT NULL
 );

ALTER TABLE ppploans_dw_lgl.ppp.facts_ppp ADD PRIMARY KEY ( fact_id )  NOT ENFORCED;

ALTER TABLE ppploans_dw_lgl.ppp.facts_ppp ADD CONSTRAINT fk_facts_ppp_dim_borrower FOREIGN KEY ( borrower_id ) REFERENCES ppploans_dw_lgl.ppp.dim_borrower( borrower_id ) NOT ENFORCED;

ALTER TABLE ppploans_dw_lgl.ppp.facts_ppp ADD CONSTRAINT fk_facts_ppp_dim_date FOREIGN KEY ( date_id ) REFERENCES ppploans_dw_lgl.ppp.dim_date( date_id ) NOT ENFORCED;

ALTER TABLE ppploans_dw_lgl.ppp.facts_ppp ADD CONSTRAINT fk_facts_ppp_dim_loan FOREIGN KEY ( loan_number ) REFERENCES ppploans_dw_lgl.ppp.dim_loan( loan_number ) NOT ENFORCED;

ALTER TABLE ppploans_dw_lgl.ppp.facts_ppp ADD CONSTRAINT fk_facts_ppp_dim_location FOREIGN KEY ( location_id ) REFERENCES ppploans_dw_lgl.ppp.dim_location( location_id ) NOT ENFORCED;

ALTER TABLE ppploans_dw_lgl.ppp.facts_ppp ADD CONSTRAINT fk_facts_ppp_dim_servicing_lender FOREIGN KEY ( lender_id ) REFERENCES ppploans_dw_lgl.ppp.dim_servicing_lender( lender_id ) NOT ENFORCED;

ALTER TABLE ppploans_dw_lgl.ppp.facts_ppp ADD CONSTRAINT fk_facts_ppp_dim_originating_lender FOREIGN KEY ( origin_lender_id ) REFERENCES ppploans_dw_lgl.ppp.dim_originating_lender( origin_lender_id ) NOT ENFORCED;